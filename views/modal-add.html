<div
    id="modal"
    _="on closeModal add .closing then wait for animationend then remove me"
>
    <div class="modal-underlay" _="on click trigger closeModal"></div>
    <div class="modal-content">
        <h1>Add</h1>
        <input type="text" name="name" placeholder="Name" data-include-add="" />
        <input
            type="text"
            name="ownerName"
            placeholder="Owner Name"
            data-include-add=""
        />
        <input
            type="text"
            name="address"
            placeholder="Address"
            data-include-add=""
        />
        <input type="text" name="city" placeholder="City" data-include-add="" />
        <input
            type="text"
            name="email"
            placeholder="Email"
            data-include-add=""
        />
        <input
            type="text"
            name="grouping"
            placeholder="Grouping"
            data-include-add=""
        />
        <div id="services-container">
            <div class="service-entry" data-include-add="">
                <input
                    type="text"
                    name="services[0].service"
                    placeholder="Service"
                />
                <input
                    type="number"
                    name="services[0].quantity"
                    placeholder="Quantity"
                />
                <input
                    type="number"
                    step="0.01"
                    name="services[0].price"
                    placeholder="Price"
                />
                <button
                    type="button"
                    class="btn-danger"
                    onclick="this.closest('.service-entry').remove()"
                >
                    <i class="nf nf-cod-trash"></i>
                </button>
            </div>
        </div>

        <button
            type="button"
            class="btn-primary"
            onclick="
                const container = document.getElementById('services-container');
                const lastEntry = container.lastElementChild;
                const lastInputName = lastEntry.querySelector('input').name;
                const newIndex = parseInt(lastInputName.match(/\[(\d+)\]/)[1]) + 1;
                
                const template = container.firstElementChild.cloneNode(true);
                const inputs = template.querySelectorAll('input');
                
                inputs[0].name = `services[${newIndex}].service`;
                inputs[1].name = `services[${newIndex}].quantity`;
                inputs[2].name = `services[${newIndex}].price`;
                inputs.forEach(input => input.value = '');
                
                container.appendChild(template);"
        >
            +
        </button>

        <br />
        <br />
        <div class="action-buttons">
            <button
                class="btn-primary"
                _="on click trigger closeModal"
                hx-post="/dogs"
                hx-target="#dogs"
                hx-indicator="#spinner"
                hx-include="[data-include-add]"
            >
                Save
            </button>
            <button
                class="btn-danger"
                _="on click trigger closeModal"
                hx-target="#dogs"
            >
                Cancel
            </button>
        </div>
    </div>
</div>
